# Прогнозирование оттока в тренажёрном зале
[Открыть проект в NBViewer](https://nbviewer.jupyter.org/github/Artemii-Kravtsov/thousands-of-hours/blob/master/11.%20%D0%9F%D1%80%D0%BE%D0%B3%D0%BD%D0%BE%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%20%D0%BE%D1%82%D1%82%D0%BE%D0%BA%D0%B0%20%D0%B2%20%D1%82%D1%80%D0%B5%D0%BD%D0%B0%D0%B6%D1%91%D1%80%D0%BD%D0%BE%D0%BC%20%D0%B7%D0%B0%D0%BB%D0%B5/11_predictive_models_for_churn.ipynb)
<br>

## Задачи 
- Обучить модели, прогнозирующие вероятность оттока (на уровне следующего месяца) для каждого клиента фитнесс-центра.
- Выполнить кластеризацию клиентов, выделить наиболее яркие группы, найти среди них целевые группы.
- Проанализировать признаки, наиболее сильно влияющие на отток, и предложить меры по снижению оттока.


## Коротко о данных 
4000 записей, где одна запись - исторические данные об одном клиенте. Одна категориальная переменная (пол клиента), шесть булевых, три дискретные, три непрерывные. Немногочисленные (меньше ста записей) несостыковки в данных. 


## Библиотеки 
`pandas` `matplotlib` `seaborn` `scipy` `plotly` `sklearn` 


## Выводы
<ol style="padding-left: 0px;"><li><p align="justify">EDA: созданы новые поля 'trend_pct', 'trend_pct_abs', 'first_time_client', '15%_vi_fr_decrease', 'vi_fr_decrease', 'elapsed_time' и 'cluster' (в результате кластеризации). Из этих полей четыре оказались в той или иной степени полезны. Удалены около 80 записей, показавшиеся странными. Выбивающихся из общей массы значений нет, пропусков нет. Из всех имеющихся переменных лишь две никак не характеризуют отток, остальные характеризуют, притом для каждой из них разница между оттоком и удержанием уходит далеко за порог статистической значимости. Благодаря этому даже ненастроенные модели отлично справляются с предсказаниями.</p></li><li><p align="justify">Признаки, влияющие на отток: если клиент получил корпоративную скидку на абонемент ('from_partner') или приглашение от друга ('promo_friends'), то он будет посещать спортзал с большей вероятностью, чем тот, кто этих скидкок не получил. Клиенты, которые ходят на групповые занятия ('group_visits'), выбывают реже тех, кто тренируется самостоятельно. Проживание вдалеке от спортзала ('lives_close') - фактор, негативно влияющий на вероятность оттока. Чаще всего заканчивается оттоком резкое увеличение или резкое уменьшение частоты посещений (переменная 'trend_pct'). Большая часть оттока приходится на клиентов, пришедших в спортзал совсем недавно (переменная 'lifetime') - практиески все тренируются не больше трёх месяцев. Также выбывшие клиенты в средне тратят меньшие суммы денег на дополнительные услуги, моложе на два года и тренируются в два раза реже тех, кто не выбывает. Около 90% выбывших - владельцы месячных абонементов.</p></li><li><p align="justify">Кластеризация: шесть кластеров - самое лучшее. Стоит отметить, что для всех варинтов кластеризации silhouette низкое - кластеризация не очень естественно ложится на полный набор признаков.</p></li><li><p align="justify">Машинное обучение: для компании приоритетной метрикой является полнота, то есть способность угадать как можно больше клиентов, которые в скором времени уйдут в отток (минимизация False Negative). Модель случайного леса даёт лучшие показатели: если при вероятности оттока большей или равной 0.3406 мы будем предсказывать отток, то будем угадывать 97 из 100 клиентов, которые в скором времени перестанут посещать спортзал. Примерно 15 из 100 таких предсказаний будут ошибочными - в этих случаях не будет оттока там, где мы его предсказали. Модель логистической регрессии несколько хуже: с ней мы сможем угадывать 94-95 из 100 клиентов, совершая 17-18 ошибок на каждые сто предсказаний оттока. Одно решающее дерево можно настроить так, чтобы угадывать 85 из 100 клиентов, ошибаясь в 21 случае, зато предсказания будут делаться за три шага.</p></li><li><p align="justify">Рекоммендации для борьбы с оттоком: сопровождать новых посетителей (низкий lifetime), или хотя бы тех из них, кто пользуется своим первым абонементом. Сопровождать тех, кто за последнее время стал тренироваться намного чаще, чем раньше. Продавать абонементы на пол года и на год, вовлекать клиентов в приятные коммуникациии. Нацелить маркетинговые компании на людей постарше и на корпоративных клиентов </p></li></ol>
